(this["webpackJsonpmy-dapp"]=this["webpackJsonpmy-dapp"]||[]).push([[0],{285:function(e,t,n){},294:function(e,t,n){},306:function(e,t){},307:function(e,t){},309:function(e,t){},313:function(e,t){},340:function(e,t){},342:function(e,t){},356:function(e,t){},358:function(e,t){},465:function(e,t){},466:function(e,t){},609:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),c=n(110),r=n.n(c),i=(n(285),n(15)),o=n(8),l=n(7),u=s.a.createContext(),d={isAuthenticated:!1,Address:null,SessionToken:null,AccessKeyId:null,SecretKey:null,Expiration:null},j=function(e,t){switch(t.type){case"LOGIN":return localStorage.setItem("address",JSON.stringify(t.payload.address)),localStorage.setItem("sessionToken",JSON.stringify(t.payload.sessionToken)),localStorage.setItem("accessKeyId",JSON.stringify(t.payload.accessKeyId)),localStorage.setItem("secretKey",JSON.stringify(t.payload.secretKey)),localStorage.setItem("expiration",JSON.stringify(t.payload.expiration)),Object(o.a)(Object(o.a)({},e),{},{isAuthenticated:!0,address:t.payload.address,sessionToken:t.payload.sessionToken,accessKeyId:t.payload.accessKeyId,SecretKey:t.payload.secretKey,expiration:t.payload.expiration});case"LOGOUT":return localStorage.clear(),Object(o.a)(Object(o.a)({},e),{},{isAuthenticated:!1,address:null,sessionToken:null,accessKeyId:null,secretKey:null,expiration:null});default:return e}},p=function(e){var t=s.a.useReducer(j,d),n=Object(i.a)(t,2),a=n[0],c=n[1];return Object(l.jsx)(u.Provider,{value:{authState:a,dispatch:c},children:e.children})},b=s.a.createContext(),h=function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),s=n[0],c=n[1];return Object(l.jsx)(b.Provider,{value:{awsClient:s,setAwsClient:c},children:e.children})},O=n(111),f=(n(294),n(40)),m=n(18),x=n.n(m),g=n(150),v=n.n(g),y=n(116),w=n.n(y),S=n(258),k=n.p+"static/media/logo.6ce24c58.svg",I=new v.a(v.a.givenProvider),N=new S.a({forwarderOrigin:"http://localhost:3000"}),T=function(){var e=s.a.useContext(u).dispatch,t=s.a.useContext(b),n=(t.awsClient,t.setAwsClient),c=s.a.useState({isSubmitting:!1,errorMessage:null,isMetamaskInstalled:!0}),r=Object(i.a)(c,2),d=r[0],j=r[1];Object(a.useEffect)((function(){p()}),[]);var p=function(){return!!function(){var e=window.ethereum;return Boolean(e&&e.isMetaMask)}()&&(!1===d.isMetamaskInstalled&&j(Object(o.a)(Object(o.a)({},d),{},{isMetamaskInstalled:!0})),!0)},h=function(){var t=Object(f.a)(x.a.mark((function t(a){var s,c,r,i,l,u,b,h,f,m;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),j(Object(o.a)(Object(o.a)({},d),{},{isSubmitting:!0,errorMessage:null})),t.prev=2,!p()){t.next=29;break}return t.next=6,window.ethereum.request({method:"eth_requestAccounts"});case 6:return s=t.sent,c=s[0],t.next=10,w()("".concat("https://wriobikkw5.execute-api.us-east-1.amazonaws.com/dev/").concat("nonce","?address=").concat(c.toLowerCase()),{method:"GET",validateStatus:!1});case 10:if(r=t.sent,i=r.data.nonce){t.next=19;break}return t.next=15,w.a.post("".concat("https://wriobikkw5.execute-api.us-east-1.amazonaws.com/dev/").concat("signup"),{address:c.toLowerCase()},{headers:{"Content-Type":"application/json"}});case 15:l=t.sent,u=l.data,console.log(u),u&&u.Attributes&&(i=u.Attributes.nonce);case 19:return t.next=21,I.eth.personal.sign(I.utils.sha3("Welcome message, nonce: ".concat(i)),c);case 21:return b=t.sent,t.next=24,w.a.post("".concat("https://wriobikkw5.execute-api.us-east-1.amazonaws.com/dev/").concat("login"),{address:c,signature:b},{headers:{"Content-Type":"application/json"}});case 24:h=t.sent,(f=h.data)&&f.AccessKeyId?(e({type:"LOGIN",payload:{isAuthenticated:!0,accessKeyId:f.AccessKeyId,address:c,sessionToken:f.SessionToken,secretKey:f.SecretKey,expiration:f.Expiration}}),m=new O.AwsClient({accessKeyId:f.AccessKeyId,secretAccessKey:f.SecretKey,sessionToken:f.SessionToken,region:"us-east-1",service:"execute-api"}),n(m)):j({isSubmitting:!1,errorMessage:"Login failed",isMetamaskInstalled:!0}),t.next=30;break;case 29:j(Object(o.a)(Object(o.a)({},d),{},{isSubmitting:!1,errorMessage:"Metamask isn't installed, Please install Metamask"}));case 30:t.next=35;break;case 32:t.prev=32,t.t0=t.catch(2),j(Object(o.a)(Object(o.a)({},d),{},{isSubmitting:!1,errorMessage:t.t0.message||t.t0.statusText}));case 35:case"end":return t.stop()}}),t,null,[[2,32]])})));return function(e){return t.apply(this,arguments)}}();return Object(l.jsx)("div",{className:"login-container",children:Object(l.jsx)("div",{className:"card",children:Object(l.jsx)("div",{className:"container",children:Object(l.jsxs)("form",{onSubmit:h,children:[Object(l.jsx)("h1",{children:"Login"}),d.errorMessage&&Object(l.jsx)("span",{className:"form-error",children:d.errorMessage}),d.isMetamaskInstalled?Object(l.jsx)("button",{disabled:d.isSubmitting,children:d.isSubmitting?Object(l.jsx)("img",{className:"spinner",src:k,alt:"loading icon"}):"Login with Metamask"}):Object(l.jsx)("button",{type:"button",onClick:function(){N.startOnboarding()},children:"Install Metamask'"})]})})})})},C=n(614),K=n(277),A=n(275),M=n(276),L="U42YTQClHQMz1dRyy087pHijX8I2-VTC",J=(Object(M.a)("wss://eth-mainnet.ws.alchemyapi.io/ws/".concat(L)),Date.now(),Object(A.a)({limit:5,interval:1e3}));var E=function(){var e=s.a.useContext(u).authState,t=Object(a.useState)(e.address),n=Object(i.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(!0),d=Object(i.a)(o,2),j=d[0],p=d[1],b=Object(a.useState)([]),h=Object(i.a)(b,2),O=h[0],m=h[1];Object(a.useEffect)((function(){c.length=="0xeb834ae72b30866af20a6ce5440fa598bfad3a42".length&&(g(c),m([]))}),[c]);var g=function(){var e=Object(f.a)(x.a.mark((function e(t){var n,a,s,c,r,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,fetch("https://eth-mainnet.g.alchemy.com/".concat(L,"/v1/getNFTs/?owner=").concat(t));case 3:return n=e.sent,e.next=6,n.json();case 6:for(a=e.sent,[],p(!1),s=0;s<a.ownedNfts.length;s++)c=a.ownedNfts[s],r=c.contract.address,i=c.id.tokenId,v(r,i).then((function(e){m((function(t){return[].concat(Object(K.a)(t),[e])}))}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(f.a)(x.a.mark((function e(t,n){var a,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=J(fetch),e.next=3,a("https://eth-mainnet.g.alchemy.com/".concat(L,"/v1/getNFTMetadata?contractAddress=").concat(t,"&tokenId=").concat(n,"&tokenType=erc721"));case 3:return s=e.sent,e.abrupt("return",s.json());case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(l.jsxs)("div",{className:"viewer",children:[Object(l.jsx)("h6",{children:"Your NFT address"}),Object(l.jsx)("input",{type:"text",value:c,onChange:function(e){var t=e.currentTarget.value.trim();r(t)}}),j&&Object(l.jsx)("p",{children:"Loading your wallet data"}),!j&&!O.length&&Object(l.jsx)("p",{children:"No NFT in this wallet"}),!j&&O.map((function(e){return function(e){var t={};if("name"in e&&(t.name=e.name),"metadata"in e){var n=e.metadata.image;if(!n)return Object(l.jsxs)("div",{className:"renderError",children:["Not supported: ",JSON.stringify(e)]});n.startsWith("ipfs://")?t.image="https://ipfs.io/ipfs/".concat(n.split("//")[1]):t.image=n}else if("externalDomainViewUrl"in e){var a=e.externalDomainViewUrl.split(","),s=Object(i.a)(a,2),c=(s[0],s[1]);if(!c)return Object(l.jsxs)("div",{className:"renderError",children:["Not supported: ",JSON.stringify(e)]});var r=JSON.parse(atob(c));t.image=r.image}return Object(l.jsxs)("div",{children:[Object(l.jsxs)("div",{children:["Name: ",{}.name]}),Object(l.jsx)("div",{children:Object(l.jsx)("img",{className:"nftImage",src:t.image})})]})}(e)}))]})};var G={marginTop:10},F=function(){var e=s.a.useContext(b).awsClient,t=Object(a.useState)({data:""}),n=Object(i.a)(t,2),c=n[0],r=n[1],o=Object(a.useState)(!1),u=Object(i.a)(o,2),d=u[0],j=u[1];return Object(a.useEffect)((function(){var t=function(){var t=Object(f.a)(x.a.mark((function t(){var n,a;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=12;break}return t.next=3,e.sign("".concat("https://wriobikkw5.execute-api.us-east-1.amazonaws.com/dev/").concat("hello","?name=there"),{method:"GET"});case 3:return n=t.sent,t.next=6,fetch(n);case 6:return a=t.sent,t.t0=r,t.next=10,a.json();case 10:t.t1=t.sent,(0,t.t0)(t.t1);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[e]),d?Object(l.jsx)(E,{}):Object(l.jsxs)("div",{className:"home",children:[Object(l.jsx)("div",{className:"content",children:Object(l.jsx)("h1",{children:c.data})}),Object(l.jsx)(C.a,{style:G,type:"primary",onClick:function(){j(!d)},children:"View Gallery"})]})},D=function(){var e=s.a.useContext(u),t=e.authState,n=e.dispatch;return Object(l.jsxs)("nav",{id:"navigation",children:[Object(l.jsx)("h1",{href:"#",className:"logo",children:"LOGO"}),Object(l.jsx)("button",{onClick:function(){return n({type:"LOGOUT"})},children:t.isAuthenticated&&Object(l.jsx)("h1",{children:"LOGOUT"})})]})};var U=function(){var e=Object(a.useContext)(u),t=e.authState,n=e.dispatch,c=Object(a.useContext)(b),r=(c.awsClient,c.setAwsClient);return s.a.useEffect((function(){var e=JSON.parse(localStorage.getItem("address")||null),t=JSON.parse(localStorage.getItem("sessionToken")||null),a=JSON.parse(localStorage.getItem("secretKey")||null),s=JSON.parse(localStorage.getItem("accessKeyId")||null),c=JSON.parse(localStorage.getItem("expiration")||null),i=new Date;if(e&&t&&c)if(new Date(c)>i){n({type:"LOGIN",payload:{address:e,sessionToken:t,secretKey:a,accessKeyId:s,expiration:c}});var o=new O.AwsClient({accessKeyId:s,secretAccessKey:a,sessionToken:t,region:"us-east-1",service:"execute-api"});r(o)}else n({type:"LOGOUT"})}),[]),console.log("authState:"),console.log(t),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(D,{}),Object(l.jsx)("div",{className:"app-container",children:t.isAuthenticated?Object(l.jsx)(F,{}):Object(l.jsx)(T,{})})]})};var P=function(){return Object(l.jsx)(p,{children:Object(l.jsx)(h,{children:Object(l.jsx)(U,{})})})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,615)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};r.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(P,{})}),document.getElementById("root")),z()}},[[609,1,2]]]);
//# sourceMappingURL=main.58b16a95.chunk.js.map